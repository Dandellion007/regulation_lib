
<%= form_with model: document, class: 'edit_form', id: 'document_form_edit'  do |form| %>
  <div class="table-responsive">
    <table class="table table-hover">
      <thead>
        <tr>
          <th>Поле</th>
          <th>Значение</th>
        </tr>
      </thead>
      <tbody>
        <% Document.all_fields.each do |field| %>
          <tr>
            <td><span class="<%= field == :designation ? 'required_field' : '' %>">
              <%= t "model.document.#{field}" %>
            </span></td>
            <td>
              <% if Document.dates.include?(field) %>
                <%= form.date_field field, value: document.last_values[field], class: 'form-control' %>
              <% elsif Document.texts.include?(field) %>
                <%= form.text_area field, value: document.last_values[field], class: 'form-control' %>
              <% elsif Document.enums.include?(field) %>
                <%= form.select(field, options_for_select(Document.send("#{field}_for_select"),
                  document.last_values[field]), {include_blank: true}, {class: 'form-select'}) %>
              <% else %>
                <% if field == :designation && @fail_field == :designation %>
                  <div>
                    <%= form.text_field field, value:document.last_values[field], class: "form-control is-invalid" %>
                    <div class="invalid-feedback">Заполните обозначение стандарта</div>
                  </div>
                <% else %>
                  <%= form.text_field field, value:document.last_values[field], class: 'form-control' %>
                <% end %>
              <% end %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>

  <div >
    <%= form.submit 'Сохранить', class: 'btn btn-primary btn-sm' %>
    <%= link_to 'Отменить', documents_path, class: 'btn btn-secondary btn-sm' %>
  </div>
<% end %>
